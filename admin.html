
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - Passport Applications</title>
  <link rel="stylesheet" href="style.css" />
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

    const SUPABASE_URL = "https://hvycjokchqstzhwbpves.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh2eWNqb2tjaHFzdHpod2JwdmVzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYwOTYyMTIsImV4cCI6MjA2MTY3MjIxMn0.Vrl9r_f5NWe0KbO_c3QqiHVMZVgXofCFpJ4BjnnVN0o";

    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

    const loginSection = document.getElementById("login-section");
    const dashboardSection = document.getElementById("dashboard");
    const tableBody = document.querySelector("#applications tbody");

    document.getElementById("login-btn").addEventListener("click", () => {
      const password = document.getElementById("admin-password").value;
      if (password === "admin123") {
        loginSection.style.display = "none";
        dashboardSection.style.display = "block";
        loadApplications();
      } else {
        alert("Incorrect password");
      }
    });

    async function loadApplications() {
      const { data, error } = await supabase.from("passport_applications").select("*").order("created_at", { ascending: false });
      if (error) {
        console.error("Error loading applications", error);
        return;
      }

      tableBody.innerHTML = "";
      data.forEach((app, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${app.first_name} ${app.last_name}</td>
          <td>${app.email || "-"}</td>
          <td>${app.dob || "-"}</td>
          <td>${app.created_at?.slice(0, 10) || "-"}</td>
        `;
        tableBody.appendChild(row);
      });
    }
  </script>
</head>
<body>
  <h1 style="text-align:center;">Admin Dashboard</h1>

  <div id="login-section" style="text-align:center;">
    <input type="password" id="admin-password" placeholder="Enter admin password" />
    <button id="login-btn">Login</button>
  </div>

  <div id="dashboard" style="display:none; padding:20px;">
    <h2>Submitted Passport Applications</h2>
    <table id="applications" border="1" cellspacing="0" cellpadding="10" style="width:100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th>#</th>
          <th>Full Name</th>
          <th>Email</th>
          <th>DOB</th>
          <th>Submitted At</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</body>
</html>
